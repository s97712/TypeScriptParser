<Project>

  <!-- 收集native库文件 -->
  <ItemGroup Condition="Exists('$(TypeScriptParserNativePath)')">
    <TypeScriptParserNativeFiles Include="$(TypeScriptParserNativePath)**/*" />
  </ItemGroup>

  <!-- 常规项目：复制到输出目录 -->
  <ItemGroup Condition="'@(TypeScriptParserNativeFiles)' != ''">
    <None Include="@(TypeScriptParserNativeFiles)" CopyToOutputDirectory="PreserveNewest" />
  </ItemGroup>

  <ItemGroup>
    <AssemblyMetadata Include="TypeScriptParserNativePath" Value="$(TypeScriptParserNativePath)" />
  </ItemGroup>

  <!-- 发布时包含native库文件（非源生成器项目） -->
  <ItemGroup Condition="'$(PublishDir)' != '' AND '@(TypeScriptParserNativeFiles)' != ''">
    <ResolvedFileToPublish Include="@(TypeScriptParserNativeFiles)">
      <RelativePath>%(Filename)%(Extension)</RelativePath>
      <CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
      <ExcludeFromSingleFile Condition="'$(PublishSingleFile)' == 'true'">true</ExcludeFromSingleFile>
    </ResolvedFileToPublish>
  </ItemGroup>

</Project>